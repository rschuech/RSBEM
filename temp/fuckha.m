function [pt, vel ,dir_norms,vecs] = transverse_hairs_parameterized(u_in, h_in, time, geom )

dir_norms = NaN(3,length(u_in));  vecs = dir_norms;  pt = vecs;  vel = pt;

for i = 1:length(u_in)
    
    dir_norm = [];   vec_t = [];
    
    u = u_in(i);
    h = h_in(i);
    
    % v = 1 by defintion
    v = 1;
    
    %this is orig out of paper, oriented vertically
    % r0 =  [(geom.R+geom.d+geom.w+geom.rf)*cos(u); ...
    %        (geom.R+geom.d+geom.w+geom.rf)*sin(u); ...
    %         geom.b*(u)] ...
    %     + ...
    %     geom.rf* ...
    %     [cos(u).*cos(geom.c*u - geom.omega*time); ...
    %      sin(u).*cos(geom.c*u - geom.omega*time); ...
    %      sin(geom.c*u - geom.omega*time)];
    %
    %    pt = v.*r0 + [(geom.R+geom.d)*(1-v).*cos(u); (geom.R+geom.d).*(1-v).*sin(u); (1-v).*geom.b.*u];
    
    
    % this is rotated -90 around y-axis as in Salome
    
    %    r0 = [  ( geom.b*(u) + geom.rf * sin(geom.c*u - geom.omega*time) ) ; ...
    %           (geom.R+geom.d+geom.w+geom.rf)*sin(u) + geom.rf* sin(u).*cos(geom.c*u - geom.omega*time); ...
    %           -( (geom.R+geom.d+geom.w+geom.rf)*cos(u) +  geom.rf*cos(u).*cos(geom.c*u - geom.omega*time) );];
    %
    %    pt = v.*r0 + [ (1-v).*geom.b.*u;  (geom.R+geom.d).*(1-v).*sin(u);   -( (geom.R+geom.d)*(1-v).*cos(u) );];
    %
    %    pt(1) = pt(1) + geom.shift; %translate in x dir
    %
    %    if nargout > 1
    %         r0_t = [  ( - geom.omega*geom.rf * cos(geom.c*u - geom.omega*time) ) ; ...
    %             geom.omega*geom.rf* sin(u).*sin(geom.c*u - geom.omega*time); ...
    %             -( geom.omega*geom.rf*cos(u).*sin(geom.c*u - geom.omega*time) );];
    %
    %         vel = v .* r0_t;
    %
    %    end
    
    
    
    
    % to be input into Salome, with spiral
    % x = v * ( (R+d+w+rf)*cos(t) + rf* cos(t)*cos(c*t - omega*time) ) + (R+d)*(1-v).*cos(t) % (v, transverse_R, transverse_d, transverse_w, transverse_rf, transverse_rf, transverse_c, transverse_omega, time, transverse_R, transverse_d, v)
    % y = v * ( (R+d+w+rf)*sin(t) + rf* sin(t)*cos(c*t - omega*time) ) + (R+d)*(1-v).*sin(t) % (v, transverse_R, transverse_d, transverse_w, transverse_rf, transverse_rf, transverse_c, transverse_omega, time, transverse_R, transverse_d, v)
    % z = v * ( -b*(t)/(2*pi) +             rf*        sin(c*t - omega*time) ) +     -(1-v).*b/(2*pi).*t % (v, transverse_b, transverse_rf, transverse_c, transverse_omega, time, v, transverse_b)
    % ZExpr = "%s * ( -%s*(t)/(2*math.pi)              + %s*        sin(%s*t - %s*%s) ) +        -(1-%s)*%s*t/(2*math.pi)"   % (v, transverse_b, transverse_rf, transverse_c, transverse_omega, time, v, transverse_b)
    
    %theta = 45 * pi/180;  %now this is again rotated by some random angle around x-axis as another Salome workaround....
    theta = 0;  %apparently don't need to rotate transverse for normal groove, only for big groove...
    
    
    %       r0 = [  ( geom.b*(u) + geom.rf * sin(geom.c*u - geom.omega*time) ) ; ...
    %           (geom.R+geom.d+geom.w+geom.rf)*sin(u) + geom.rf* sin(u).*cos(geom.c*u - geom.omega*time); ...
    %           -( (geom.R+geom.d+geom.w+geom.rf)*cos(u) +  geom.rf*cos(u).*cos(geom.c*u - geom.omega*time) );];
    
    r0 = [ ( (geom.R+geom.d+geom.w+geom.rf)*cos(u) +  geom.rf* cos(u).*cos(geom.c*u - geom.omega*time) );...
        (geom.R+geom.d+geom.w+geom.rf)*sin(u) +  geom.rf* sin(u).*cos(geom.c*u - geom.omega*time); ...
        ( -geom.b/(2*pi)*(u)                  +  geom.rf *        sin(geom.c*u - geom.omega*time) ) ; ];
    
    %     rotmat = rotation_matrix('x',pi) * rotation_matrix('y',pi/2);
    
    %     r0 = rotmat * r0;
    %     temp = rotmat * [ (geom.R+geom.d).*(1-v).*cos(u);   ( (geom.R+geom.d)*(1-v).*sin(u) );  -(1-v).*geom.b/(2*pi).*u;];
    temp = [ (geom.R+geom.d).*(1-v).*cos(u);   ( (geom.R+geom.d)*(1-v).*sin(u) );  -(1-v).*geom.b/(2*pi).*u;];
    
    pt_edge = v.*r0 + temp;
    
    
    
    %     pt_edge(1) = pt_edge(1) + geom.shift; %translate in x dir
    if nargout >= 2
    r0_t = [ (geom.omega *  geom.rf* cos(u).*sin(geom.c*u - geom.omega*time) );...
        geom.omega *  geom.rf* sin(u).*sin(geom.c*u - geom.omega*time); ...
        (      -geom.omega *  geom.rf*         cos(geom.c*u - geom.omega*time) ) ; ];
    %     r0_t = rotmat * r0_t;
    vel_edge = v .* r0_t;
    end
    r0_u = [  -(geom.R+geom.d+geom.w+geom.rf)*sin(u)  +  geom.rf *( -sin(u).*cos(geom.c.*u - geom.omega*time) - cos(u).*geom.c.*sin(geom.c*u - geom.omega*time) ); ...
        (geom.R+geom.d+geom.w+geom.rf)*cos(u)  +  geom.rf *(  cos(u).*cos(geom.c.*u - geom.omega*time) - sin(u).*geom.c.*sin(geom.c*u - geom.omega*time) ); ...
        -geom.b/(2*pi)                         +  geom.rf * geom.c*cos(geom.c*u - geom.omega*time) ];
    
    %     r0_u = rotmat * r0_u;
    
    %     temp_u = rotmat * [ -(geom.R+geom.d).*(1-v).*sin(u);   ( (geom.R+geom.d)*(1-v).*cos(u) );  -(1-v).*geom.b/(2*pi);];
    temp_u =  [ -(geom.R+geom.d).*(1-v).*sin(u);   ( (geom.R+geom.d)*(1-v).*cos(u) );  -(1-v).*geom.b/(2*pi);];
    
    pt_u = v.*r0_u + temp_u;
    
    % temp = [ (geom.R+geom.d).*(1-v).*cos(u);   ( (geom.R+geom.d)*(1-v).*sin(u) );  -(1-v).*geom.b/(2*pi).*u;];
    %     temp_v =  rotmat * [ -(geom.R+geom.d).*cos(u);   -(geom.R+geom.d).*sin(u);  geom.b/(2*pi).*u;];
    temp_v =  [ -(geom.R+geom.d).*cos(u);   -(geom.R+geom.d).*sin(u);  geom.b/(2*pi).*u;];
    
    %     pt_v = rotmat * r0 + temp_v;  %cause r0 is just a constant WRT v and we have v*r0 in expression for pt
    pt_v =  r0 + temp_v;  %cause r0 is just a constant WRT v and we have v*r0 in expression for pt
    
    %      rotmat = rotation_matrix('x',pi) * rotation_matrix('y',pi/2);
    %       pt_us(:,i) = rotmat * pt_u;
    %       pt_vs(:,i) = rotmat* pt_v;
    
    
    %     pt_v = rotmat *  [ ( (geom.R+geom.d+geom.w+geom.rf)*cos(u) +  geom.rf* cos(u).*cos(geom.c*u - geom.omega*time) )   -(geom.R+geom.d).*cos(u)    ;...
    %         (geom.R+geom.d+geom.w+geom.rf)*sin(u) +  geom.rf* sin(u).*cos(geom.c*u - geom.omega*time)      -(geom.R+geom.d).*sin(u); ...
    %         ( -geom.b/(2*pi)*(u)                  +  geom.rf *        sin(geom.c*u - geom.omega*time) )   +   geom.b/(2*pi).*u   ; ];
    
    % version input to Maple
    %     pt_v = rotmat *  [ ( (R+d+w+rf)*cos(u) +  rf* cos(u)*cos(c*u - omega*time) )   -(R+d)*cos(u)    ;...
    %         (R+d+w+rf)*sin(u) +  rf* sin(u)*cos(c*u - omega*time)      -(R+d)*sin(u); ...
    %         ( -b/(2*pi)*(u)                  +  rf *        sin(c*u - omega*time) )   +   b/(2*pi)*u   ; ];
    
    C1 = (geom.R+geom.d+geom.w+geom.rf);  C2 = (geom.R + geom.d);  C3 = geom.b/(2*pi);
    rf = geom.rf;     c = geom.c;   omega = geom.omega;  R = geom.R;    d = geom.d;   b = geom.b;  w = geom.w;
    
    switch geom.wingtip_type
        case 'normal'
            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
            
            
            %     pt_u_cross_pt_v = [ ( v*( C1*cos(u)  +  rf *(  cos(u)*cos(c*u - omega*time) - sin(u)*c*sin(c*u - omega*time) ) )  + C2*(1-v)*cos(u)  )  * ( ( -C3*(u)                  +  rf *        sin(c*u - omega*time) )  +  C3*u )            -      (  v * ( -C3                         +  rf * c*cos(c*u - omega*time) ) -(1-v)*C3 )  *  ( C1*sin(u) +  rf* sin(u)*cos(c*u - omega*time)   -C2*sin(u) ) ; ...
            %                        (  v*( -C3                         +  rf * c*cos(c*u - omega*time))  -(1-v)*C3 ) * ( C1*cos(u) +  rf* cos(u)*cos(c*u - omega*time)  -C2*cos(u) )     -    (  v*(  -C1*sin(u)  +  rf *( -sin(u)*cos(c*u - omega*time) - cos(u)*c*sin(c*u - omega*time) ))   -C2*(1-v)*sin(u)  )  *  ( ( -C3*(u)                  +  rf *        sin(c*u - omega*time) ) +  C3*u  ); ...
            %                        ( v*( -C1*sin(u)  +  rf *( -sin(u)*cos(c*u - omega*time) - cos(u)*c*sin(c*u - omega*time) )) +  -C2*(1-v)*sin(u)  )  *   ( C1*sin(u) +  rf* sin(u)*cos(c*u - omega*time)  +    -C2*sin(u)  )  -      (  v* ( C1*cos(u)  +  rf *(  cos(u)*cos(c*u - omega*time) - sin(u)*c*sin(c*u - omega*time)  )  )  +  ( C2*(1-v)*cos(u) )  )   *  ( ( C1*cos(u) +  rf* cos(u)*cos(c*u - omega*time) )    -C2*cos(u)  );  ];
            
            %  cross product between u der and v der, normalized
            dir_norm =  [   ((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)   ; ...
                ((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)         ; ...
                ((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)   ];
            
            if abs(dot(dir_norm, pt_u)) > eps*100  ||  abs(dot(dir_norm, pt_v)) > eps*100
                stopafro
            end
            uxv =   cross(pt_u, pt_v);
            if abs(dot(dir_norm, uxv / sqrt(sum(uxv.^2))) - 1) > eps*100
                stopafroo
            end
            
            if nargout >= 2
            %time derivative of vec....
            vec_t = h * [  (v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)-(1/2)*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))*((2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+(2*(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*(-v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega+v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*(-v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega+v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega))/(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)^(3/2) ; ...
                (v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)-(1/2)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))*((2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+(2*(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*(-v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega+v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*(-v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega+v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega))/(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)^(3/2) ; ...
                (v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)-(1/2)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+(2*(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*(-v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega+v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*(-v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega+v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega))/(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)^(3/2)   ];
            end
            
        case 'parallel_1'   %hairs point radially out, along lines of constant u = dir of v derivative, in plane of transverse
            % pt_v normalized
            dir_norm = [cos(u)*(w+rf+rf*cos(c*u-omega*time))/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time)) ;...
                sin(u)*(w+rf+rf*cos(c*u-omega*time))/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time));...
                rf*sin(c*u-omega*time)/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time)) ];
            
            
            if nargout >= 2
            % pt_v_normalized time derivatived
            vec_t = h * [  cos(u)*rf*sin(c*u-omega*time)*omega/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))-(1/2)*cos(u)*(w+rf+rf*cos(c*u-omega*time))*(2*w*rf*sin(c*u-omega*time)*omega+2*rf^2*sin(c*u-omega*time)*omega)/(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))^(3/2)  ;...
                sin(u)*rf*sin(c*u-omega*time)*omega/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))-(1/2)*sin(u)*(w+rf+rf*cos(c*u-omega*time))*(2*w*rf*sin(c*u-omega*time)*omega+2*rf^2*sin(c*u-omega*time)*omega)/(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))^(3/2)  ;...
                -(1/2)*rf*sin(c*u-omega*time)*(2*w*rf*sin(c*u-omega*time)*omega+2*rf^2*sin(c*u-omega*time)*omega)/(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))^(3/2)-rf*cos(c*u-omega*time)*omega/sqrt(2*w*rf*cos(c*u-omega*time)+2*rf^2+w^2+2*w*rf+2*rf^2*cos(c*u-omega*time))      ];
            end
        case 'parallel_2'  %hairs point out normal to transverse edge, in plane of transverse
            %               r0_u = [  -(geom.R+geom.d+geom.w+geom.rf)*sin(u)  +  geom.rf *( -sin(u).*cos(geom.c.*u - geom.omega*time) - cos(u).*geom.c.*sin(geom.c*u - geom.omega*time) ); ...
            %                (geom.R+geom.d+geom.w+geom.rf)*cos(u)  +  geom.rf *(  cos(u).*cos(geom.c.*u - geom.omega*time) - sin(u).*geom.c.*sin(geom.c*u - geom.omega*time) ); ...
            %                -geom.b/(2*pi)                         +  geom.rf * geom.c*cos(geom.c*u - geom.omega*time) ];
            
            %  pt_u repeated explicitly
            u1 = v* ( -(geom.R+geom.d+geom.w+geom.rf)*sin(u)  +  geom.rf *( -sin(u).*cos(geom.c.*u - geom.omega*time) - cos(u).*geom.c.*sin(geom.c*u - geom.omega*time) )) + -(geom.R+geom.d).*(1-v).*sin(u);
            u2 = v* ( (geom.R+geom.d+geom.w+geom.rf)*cos(u)  +  geom.rf *(  cos(u).*cos(geom.c.*u - geom.omega*time) - sin(u).*geom.c.*sin(geom.c*u - geom.omega*time) )) + ( (geom.R+geom.d)*(1-v).*cos(u) );
            u3 = v * ( -geom.b/(2*pi)                         +  geom.rf * geom.c*cos(geom.c*u - geom.omega*time) ) +  -(1-v).*geom.b/(2*pi);
            
            %pt_u cross pt_v from Maple (not normalized since don't need to
            %yet)
            d1 = (v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u));
            d2 =  (v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time);
            d3 =  (v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u));
            
            
            %             1.  u and n are normal, so u dot n  = 0
            % 2.  n is in same plane as u and v and u cross n must point in
            % same dir as u cross v, so dot( u cross n normalized, u cross v normalized) = 1
            %             3.  n is unit vector, so sqrt(sum(sqrs)) = 0
            
            n_mag = sqrt( d3^2*u2^2-2*u2*u3*d3*d2+d2^2*u3^2+d1^2*u3^2-2*d1*u3*u1*d3+u1^2*d3^2+d1^2*u2^2-2*d1*u2*u1*d2+u1^2*d2^2 );
            
            n1 =    ( -u2*d3+u3*d2) / n_mag  ;
            n2 = (d1*u3-u1*d3) / n_mag;
            n3  = (d1*u2-u1*d2)  / n_mag;
            
            u_cross_v_norm =  [   ((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)   ; ...
                ((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)         ; ...
                ((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))/sqrt(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2+(-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2+(-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2)   ];
            
            
            negations = [1 1 1; -1 1 1; 1 -1 1; 1 1 -1; -1 -1 1; 1 -1 -1; -1 1 -1; -1 -1 -1;];
            n1_0 = n1;  n2_0 = n2;  n3_0 = n3;
            condition = true(4,1);
            
            %%
            n = 3;  %seems to always work?
            n1 = negations(n,1) * n1_0;
            n2 = negations(n,2) * n2_0;
            n3 = negations(n,3) * n3_0;
            
            condition(1) = abs( n1*u1+n2*u2+n3*u3 ) > eps*1000;
            condition(2) = abs( n1*d1+n2*d2+n3*d3 ) > eps*1000 ;
            condition(3)  = abs(sqrt( n1^2+n2^2+n3^2) - 1 ) > eps*1000;
            u_cross_n_norm =    [(u2*n3 - u3*n2)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 );...
                (u3*n1 - u1*n3)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 );...
                (u1*n2 - u2*n1)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 )];
            
            
            condition(4) = abs( dot(u_cross_n_norm, u_cross_v_norm) - 1 )  > eps*1000;
            
            if any(condition)
                disp('problemo')
                n1 = NaN;  n2 = NaN;  n3 = NaN;
            end
            %%
            
            %            n = 0;
            %             while any(condition)
            %                 n = n+1;
            %                 if n > size(negations,1)
            % %                    pt(:,i) = NaN(3,1);
            % %                    vel(:,i) = NaN(3,1);
            % %                    dir_norms(:,i) = NaN(3,1);
            % %                    vecs(:,i) = NaN(3,1);
            %                    n1 = NaN;  n2 = NaN;  n3 = NaN;
            %                   break
            %                 end
            %                 n1 = negations(n,1) * n1_0;
            %                 n2 = negations(n,2) * n2_0;
            %                 n3 = negations(n,3) * n3_0;
            %
            %             condition(1) = abs( n1*u1+n2*u2+n3*u3 ) > eps*100;
            %             condition(2) = abs( n1*d1+n2*d2+n3*d3 ) > eps*100 ;
            %             condition(3)  = abs(sqrt( n1^2+n2^2+n3^2) - 1 ) > eps*100;
            %
            %
            %             % pt_u cross n should be in same dir as pt_u cross pt_v, and
            %             % they're exactly the same after normalization
            %
            %             % pt_u cross n, normalized
            %             u_cross_n_norm =    [(u2*n3 - u3*n2)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 );...
            %                 (u3*n1 - u1*n3)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 );...
            %                 (u1*n2 - u2*n1)  /  sqrt( (u2*n3 - u3*n2)^2 + (u3*n1 - u1*n3)^2 + (u1*n2 - u2*n1)^2 )];
            %
            %
            %            condition(4) = abs( dot(u_cross_n_norm, u_cross_v_norm) - 1 )  > eps*100;
            %
            %
            %             end
            
            
            dir_norm = [n1 n2 n3]' / sqrt(n1^2+n2^2+n3^2);
            %             dir_norm = [n1 n2 n3]';
            if nargout >= 2
                vec_t(1,1) = (2*((1/2)*v^2*rf^2*c*pi*sin(u)*(sin(u)^2-1+cos(u)^2)*cos(c*u-omega*time)^3+(1/4)*v*rf*(2*v*rf*pi*cos(u)*(c^2+3*sin(u)^2+3*cos(u)^2)*sin(c*u-omega*time)+(4*pi*((-C2+C1)*v+(1/2)*C2)*c*cos(u)^2+4*pi*((-C2+C1)*v+(1/2)*C2)*c*sin(u)^2-2*pi*c*(-C2+C1)*v+b-2*c*pi*C2)*sin(u))*cos(c*u-omega*time)^2+(-v^2*rf^2*c*pi*sin(u)*(sin(u)^2-1+cos(u)^2)*sin(c*u-omega*time)^2+v*rf*cos(u)*pi*((rf*v+(w+2*C1-2*C2)*v+C2+R+d)*cos(u)^2+(rf*v+(w+2*C1-2*C2)*v+C2+R+d)*sin(u)^2+((-C2+C1)*v*c-C3)*c)*sin(c*u-omega*time)+(1/4*((-C2+C1)*v+C2))*(2*pi*c*(-C2+C1)*v*cos(u)^2+2*pi*c*(-C2+C1)*v*sin(u)^2+b)*sin(u))*cos(c*u-omega*time)+((1/2)*v^2*c^2*pi*rf^2*cos(u)*sin(c*u-omega*time)^2-(1/4)*v*rf*(4*pi*((-C2+C1)*v+(1/2)*C2)*c*cos(u)^2+4*pi*((-C2+C1)*v+(1/2)*C2)*c*sin(u)^2-2*pi*c*(-C2+C1)*v+b-2*c*pi*C2)*sin(u)*sin(c*u-omega*time)+((v*((-C2+C1)*v+(1/2)*C2)*rf+(-C2+C1)*((1/2)*C1-(1/2)*C2+w)*v^2+(((1/2)*C2+R+d)*C1-C2*((1/2)*C2+R+d-(1/2)*w))*v+(1/2)*C2*(R+d))*pi*cos(u)^2+(v*((-C2+C1)*v+(1/2)*C2)*rf+(-C2+C1)*((1/2)*C1-(1/2)*C2+w)*v^2+(((1/2)*C2+R+d)*C1-C2*((1/2)*C2+R+d-(1/2)*w))*v+(1/2)*C2*(R+d))*pi*sin(u)^2-(1/4)*c*(-C2+C1)*(2*pi*C3+b)*v+(1/4)*C3*b)*cos(u))*sin(c*u-omega*time)))*rf*omega/(sqrt(((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2)*pi)-(1/2)*(-(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*((2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)-2*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*v*rf*c*sin(c*u-omega*time)*omega*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*c*sin(c*u-omega*time)*omega+(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*c*sin(c*u-omega*time)*omega-(2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*v*rf*c*sin(c*u-omega*time)*omega*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+(2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u)))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)+2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)-(2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)+2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega))/(((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2)^(3/2)  ;
                vec_t(2,1) = -(2*(-(1/2)*v^2*rf^2*cos(u)*c*pi*(sin(u)^2-1+cos(u)^2)*cos(c*u-omega*time)^3-(1/4)*v*(-2*v*rf*pi*sin(u)*(c^2+3*sin(u)^2+3*cos(u)^2)*sin(c*u-omega*time)+cos(u)*(4*pi*((-C2+C1)*v+(1/2)*C2)*c*cos(u)^2+4*pi*((-C2+C1)*v+(1/2)*C2)*c*sin(u)^2-2*pi*c*(-C2+C1)*v+b-2*c*pi*C2))*rf*cos(c*u-omega*time)^2+(v^2*rf^2*cos(u)*c*pi*(sin(u)^2-1+cos(u)^2)*sin(c*u-omega*time)^2+v*((rf*v+(w+2*C1-2*C2)*v+C2+R+d)*cos(u)^2+(rf*v+(w+2*C1-2*C2)*v+C2+R+d)*sin(u)^2+((-C2+C1)*v*c-C3)*c)*rf*sin(u)*pi*sin(c*u-omega*time)-(1/4*(2*pi*c*(-C2+C1)*v*cos(u)^2+2*pi*c*(-C2+C1)*v*sin(u)^2+b))*cos(u)*((-C2+C1)*v+C2))*cos(c*u-omega*time)+sin(c*u-omega*time)*((1/2)*v^2*c^2*pi*rf^2*sin(u)*sin(c*u-omega*time)^2+(1/4)*v*cos(u)*rf*(4*pi*((-C2+C1)*v+(1/2)*C2)*c*cos(u)^2+4*pi*((-C2+C1)*v+(1/2)*C2)*c*sin(u)^2-2*pi*c*(-C2+C1)*v+b-2*c*pi*C2)*sin(c*u-omega*time)+((v*((-C2+C1)*v+(1/2)*C2)*rf+(-C2+C1)*((1/2)*C1-(1/2)*C2+w)*v^2+(((1/2)*C2+R+d)*C1-C2*((1/2)*C2+R+d-(1/2)*w))*v+(1/2)*C2*(R+d))*pi*cos(u)^2+(v*((-C2+C1)*v+(1/2)*C2)*rf+(-C2+C1)*((1/2)*C1-(1/2)*C2+w)*v^2+(((1/2)*C2+R+d)*C1-C2*((1/2)*C2+R+d-(1/2)*w))*v+(1/2)*C2*(R+d))*pi*sin(u)^2-(1/4)*c*(-C2+C1)*(2*pi*C3+b)*v+(1/4)*C3*b)*sin(u))))*rf*omega/(sqrt(((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2)*pi)-(1/2)*(((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)-(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*((2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)-2*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*v*rf*c*sin(c*u-omega*time)*omega*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*c*sin(c*u-omega*time)*omega+(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*c*sin(c*u-omega*time)*omega-(2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*v*rf*c*sin(c*u-omega*time)*omega*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+(2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u)))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)+2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*(v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(u)*sin(c*u-omega*time)*omega-v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(u)*sin(c*u-omega*time)*omega)+(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega)+2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)-(2*(v*rf^2*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*cos(c*u-omega*time)*omega-v*rf*c*sin(c*u-omega*time)*omega*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*sin(u)*sin(c*u-omega*time)*omega))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*v*rf*(cos(u)*sin(c*u-omega*time)*omega+sin(u)*c*cos(c*u-omega*time)*omega)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega)+(2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*v*rf*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)+2*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))*(v*rf*c*sin(c*u-omega*time)*omega*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))+(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*rf*cos(u)*sin(c*u-omega*time)*omega-v*rf^2*(-sin(u)*sin(c*u-omega*time)*omega+cos(u)*c*cos(c*u-omega*time)*omega)*sin(c*u-omega*time)+(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*cos(c*u-omega*time)*omega))/(((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2)^(3/2) ;
                vec_t(3,1) = - (rf*(cos(u)^2+sin(u)^2)^2*omega*(rf^7*c^5*(pi*cos(c*u-omega*time)*c*v*rf-(1/2)*b)*pi*v^5*sin(c*u-omega*time)^8+(3*((2/3*(sin(u)^4+2*cos(u)^2*sin(u)^2+2*c^2+1/2+cos(u)^4))*rf^3*c^2*pi^2*v^3*cos(c*u-omega*time)^3+rf^2*c^2*pi*(2*pi*((-C2+C1)*v+(1/2)*C2)*cos(u)^4+pi*(((4*C1-4*C2)*v+2*C2)*sin(u)^2+(w+rf+C2-C1)*v+d-C2+R)*cos(u)^2+2*pi*((-C2+C1)*v+(1/2)*C2)*sin(u)^4+pi*((w+rf+C2-C1)*v+d-C2+R)*sin(u)^2+pi*(1+c^2)*(-C2+C1)*v+(-c*C3+C2)*pi-(5/6)*c*b)*v^2*cos(c*u-omega*time)^2+(4/3)*rf*((3/2)*c^2*((-C2+C1)^2*v^2+C2*(-C2+C1)*v+(1/6)*C2^2)*pi^2*cos(u)^4+(3*c*((-C2+C1)^2*v^2+C2*(-C2+C1)*v+(1/6)*C2^2)*pi*sin(u)^2+(pi*c*(-C2+C1)*v+(1/2)*c*pi*C2-(1/4)*b)*((w+rf+C2-C1)*v+d-C2+R))*c*pi*cos(u)^2+(3/2)*c^2*((-C2+C1)^2*v^2+C2*(-C2+C1)*v+(1/6)*C2^2)*pi^2*sin(u)^4+c*pi*(pi*c*(-C2+C1)*v+(1/2)*c*pi*C2-(1/4)*b)*((w+rf+C2-C1)*v+d-C2+R)*sin(u)^2+(1/4)*pi^2*c^2*(-C2+C1)*(C1+w-C2+rf)*v^2+(1/4)*c*((c*pi*C2+(1/2)*b)*rf+(-2*C2^2+(w+2*C1+3*c*C3-d-R)*C2+C1*(R-3*c*C3+d))*c*pi-(3/2*((-1-c^2)*C2+C1+c^2*C1-(1/3)*w))*b)*pi*v+(1/4)*C2*c^2*(C2+R+d)*pi^2+(1/8)*c*b*(3*c*C3+d-3*C2+R)*pi-(1/16)*b^2+(1/16)*b^2*c^2)*v*cos(c*u-omega*time)+(2/3)*c^2*pi^2*((-C2+C1)*v+C2)*((-C2+C1)*v+(1/2)*C2)*(-C2+C1)*v*cos(u)^4+(1/3*(4*c*pi*((-C2+C1)*v+C2)*((-C2+C1)*v+(1/2)*C2)*(-C2+C1)*v*sin(u)^2+(pi*c*(-C2+C1)^2*v^2+(-C2+C1)*(c*pi*C2-b)*v-(1/2)*C2*b)*((w+rf+C2-C1)*v+d-C2+R)))*c*pi*cos(u)^2+(2/3)*c^2*pi^2*((-C2+C1)*v+C2)*((-C2+C1)*v+(1/2)*C2)*(-C2+C1)*v*sin(u)^4+(1/3*(pi*c*(-C2+C1)^2*v^2+(-C2+C1)*(c*pi*C2-b)*v-(1/2)*C2*b))*c*pi*((w+rf+C2-C1)*v+d-C2+R)*sin(u)^2-(1/6*(pi*(-C2+C1)*c*(C1+w-C2+rf)*v^2+((c*pi*C2+(1/2)*b)*rf+(-2*C2^2+(w+2*C1+3*c*C3-d-R)*C2+C1*(R-3*c*C3+d))*c*pi+(1/2)*w*b)*v+c*C2*(C2+R+d)*pi+(1/2)*b*(R+d)))*b))*rf^5*c^2*v^3*sin(c*u-omega*time)^6+2*rf^3*(rf^5*c^2*pi^2*((3/2+c^2)*cos(u)^4+((3+2*c^2)*sin(u)^2+3*c^2)*cos(u)^2+(3/2+c^2)*sin(u)^4+3*c^2*sin(u)^2+3*c^4+(1/2)*c^2)*v^5*cos(c*u-omega*time)^5+3*rf^4*c*pi*(((rf+(-(7/6)*c^2-3/2)*C2+w+(7/6)*c^2*C1+(3/2)*C1)*v+((1/2)*c^2+5/6)*C2+R+d-(1/6)*c*C3)*c*pi*cos(u)^4+(2*(((rf+(-(7/6)*c^2-3/2)*C2+w+(7/6)*c^2*C1+(3/2)*C1)*v+((1/2)*c^2+5/6)*C2+R+d-(1/6)*c*C3)*pi*sin(u)^2+(2/3*((c^2-1/8)*rf+(-1/8-(3/2)*c^2)*C2+(w+(3/2)*C1)*c^2+(1/8)*C1-(1/8)*w))*pi*v+(((1/6)*c^2+1/12)*C2+((2/3)*d+(2/3)*R)*c^2-(5/12)*c*C3-(1/12)*R-(1/12)*d)*pi-(5/24)*c*b))*c*cos(u)^2+((rf+(-(7/6)*c^2-3/2)*C2+w+(7/6)*c^2*C1+(3/2)*C1)*v+((1/2)*c^2+5/6)*C2+R+d-(1/6)*c*C3)*c*pi*sin(u)^4+(4/3*(((c^2-1/8)*rf+(-1/8-(3/2)*c^2)*C2+(w+(3/2)*C1)*c^2+(1/8)*C1-(1/8)*w)*pi*v+(((1/4)*c^2+1/8)*C2+(R+d)*c^2-(5/8)*c*C3-(1/8)*R-(1/8)*d)*pi-(5/16)*c*b))*c*sin(u)^2+(1/6)*c*pi*((1+c^2)*rf+(-9*c^4-4*c^2)*C2+9*c^4*C1+(4*C1+w)*c^2+w)*v+(1/6)*c*(4*C2*c^2-9*c^3*C3+(R+d)*c^2+R+d)*pi-(3/4*(-1/9-(1/9)*c^2+c^4))*b)*v^4*cos(c*u-omega*time)^4+rf^3*(c^2*((rf^2+(-10*C2+2*w+10*C1)*rf+(4*c^2+4)*C2^2+(-8*C1-10*w-8*c^2*C1)*C2+w^2+10*w*C1+4*c^2*C1^2+4*C1^2)*v^2+(((11/2)*C2+2*R+2*d)*rf+(-9/2-(7/2)*c^2)*C2^2+((7/2)*c^2*C1-10*R+(11/2)*w-10*d+(9/2)*C1+2*c*C3)*C2-2*c*C3*C1+(2*(5*C1+w))*(R+d))*v+((1/2)*c^2+1)*C2^2+((11/2)*d+(11/2)*R-(1/2)*c*C3)*C2+(R+d)^2)*pi^2*cos(u)^4+2*c*(c*((rf^2+(-10*C2+2*w+10*C1)*rf+(4*c^2+4)*C2^2+(-8*C1-10*w-8*c^2*C1)*C2+w^2+10*w*C1+4*c^2*C1^2+4*C1^2)*v^2+(((11/2)*C2+2*R+2*d)*rf+(-9/2-(7/2)*c^2)*C2^2+((7/2)*c^2*C1-10*R+(11/2)*w-10*d+(9/2)*C1+2*c*C3)*C2-2*c*C3*C1+(2*(5*C1+w))*(R+d))*v+((1/2)*c^2+1)*C2^2+((11/2)*d+(11/2)*R-(1/2)*c*C3)*C2+(R+d)^2)*pi*sin(u)^2+(1/4*(rf^2+(2*w+4*C2-4*C1+17*c^2*C1-17*C2*c^2)*rf+(3+7*c^2)*C2^2+((-14*C1-17*w)*c^2-6*C1+4*w)*C2+(17*w*C1+7*C1^2)*c^2+(w-C1)*(w-3*C1)))*c*pi*v^2+(((1/2*((3*c^2-1)*C2+d-(5/2)*c*C3+R))*c*pi-(3/4)*c^2*b+(1/4)*b)*rf+(17/4*((-4/17-(1/17)*c^2)*C2^2+((-d-R+(1/17)*C1+(6/17)*w)*c^2+(11/17)*c*C3+(4/17)*C1+(4/17)*R+(4/17)*d-(2/17)*w)*C2+C1*(R+d)*c^2-(5/17*(w+(11/5)*C1))*C3*c+(2/17*(w-2*C1))*(R+d)))*c*pi-(3/4*((-(5/3)*c^2-1/3)*C2+((5/3)*C1+w)*c^2-(1/3)*w+(1/3)*C1))*b)*v+(1/4)*c*((-2*c^2+1)*C2^2+((6*R+6*d)*c^2-3*c*C3-2*d-2*R)*C2+(R+d)*(R+d-5*c*C3))*pi-(3/4*((1/3+(1/3)*c^2)*C2+(R+d)*c^2-(2/3)*c*C3-(1/3)*R-(1/3)*d))*b)*pi*cos(u)^2+c^2*((rf^2+(-10*C2+2*w+10*C1)*rf+(4*c^2+4)*C2^2+(-8*C1-10*w-8*c^2*C1)*C2+w^2+10*w*C1+4*c^2*C1^2+4*C1^2)*v^2+(((11/2)*C2+2*R+2*d)*rf+(-9/2-(7/2)*c^2)*C2^2+((7/2)*c^2*C1-10*R+(11/2)*w-10*d+(9/2)*C1+2*c*C3)*C2-2*c*C3*C1+(2*(5*C1+w))*(R+d))*v+((1/2)*c^2+1)*C2^2+((11/2)*d+(11/2)*R-(1/2)*c*C3)*C2+(R+d)^2)*pi^2*sin(u)^4+(1/2*((rf^2+(2*w+4*C2-4*C1+17*c^2*C1-17*C2*c^2)*rf+(3+7*c^2)*C2^2+((-14*C1-17*w)*c^2-6*C1+4*w)*C2+(17*w*C1+7*C1^2)*c^2+(w-C1)*(w-3*C1))*c*pi*v^2+(((2*((3*c^2-1)*C2+d-(5/2)*c*C3+R))*c*pi-3*c^2*b+b)*rf+(17*((-4/17-(1/17)*c^2)*C2^2+((-d-R+(1/17)*C1+(6/17)*w)*c^2+(11/17)*c*C3+(4/17)*C1+(4/17)*R+(4/17)*d-(2/17)*w)*C2+C1*(R+d)*c^2-(5/17*(w+(11/5)*C1))*C3*c+(2/17*(w-2*C1))*(R+d)))*c*pi-(3*((-(5/3)*c^2-1/3)*C2+((5/3)*C1+w)*c^2-(1/3)*w+(1/3)*C1))*b)*v+c*((-2*c^2+1)*C2^2+((6*R+6*d)*c^2-3*c*C3-2*d-2*R)*C2+(R+d)*(R+d-5*c*C3))*pi-(3*((1/3+(1/3)*c^2)*C2+(R+d)*c^2-(2/3)*c*C3-(1/3)*R-(1/3)*d))*b))*c*pi*sin(u)^2+(2*((c^2+3/4)*rf+(-(3/4)*c^4-(3/4)*c^2)*C2+(3/4)*c^4*C1+(w+(3/4)*C1)*c^2+(3/4)*w))*c^2*pi^2*(-C2+C1)*v^2+(2*((-(1/4)*c*((-3*c^2-3)*C2+c*C3)*pi-(1/8)*b)*rf+(-c^2*C2^2+((15/4)*c^3*C3+(-R+(3/4)*w+C1-d)*c^2+(1/2)*c*C3+(3/4)*w-(3/4)*d-(3/4)*R)*C2-(15/4)*c^3*C3*C1+C1*(R+d)*c^2-(1/4)*C3*(w+2*C1)*c+(3/4)*C1*(R+d))*c*pi-(3/2*((-(1/12)*c^2+1/4-c^4)*C2+(1/12)*c^2*C1+c^4*C1+(1/12)*w-(1/4)*C1))*b))*c*pi*v-(1/2)*c^2*(-c^2*C2^2+((-3*R-3*d)*c^2+2*c*C3-3*R-3*d)*C2+c*C3*(R-3*c*C3+d))*pi^2-(1/4)*c*((4*c^2-3)*C2-12*c^3*C3+d+3*c*C3+R)*b*pi-(1/4)*b^2*c^2-(1/8)*b^2+(3/8)*c^4*b^2)*v^3*cos(c*u-omega*time)^3+3*rf^2*(c^2*pi^2*((rf^2+(4*C1-4*C2+2*w)*rf+(1/3)*c^2*C2^2+(-(2/3)*c^2*C1-4*w)*C2+(1/3)*c^2*C1^2+w*(4*C1+w))*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(9/2)*C2^2+(-2*d+(9/2)*C1+w-2*R)*C2+2*C1*(R+d))*rf+(1/2)*c^2*C2^3+(-(9/2)*w+4*d-c^2*C1+4*R-c*C3)*C2^2+((1/2)*c^2*C1^2+2*c*C3*C1+(-8*d-8*R+(9/2)*w)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/2)*c*C3*C1+(w+2*C1)*(R+d)))*v^2+(C2*(C2+R+d)*rf-(1/6)*c^2*C2^3+(w+(1/6)*c^2*C1-(9/2)*R+(1/2)*c*C3-(9/2)*d)*C2^2+(-(1/2)*c*C3*C1-(R-(9/2)*C1+d-w)*(R+d))*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(R+d+2*C2))*cos(u)^4+2*c*pi*(c*pi*((rf^2+(4*C1-4*C2+2*w)*rf+(1/3)*c^2*C2^2+(-(2/3)*c^2*C1-4*w)*C2+(1/3)*c^2*C1^2+w*(4*C1+w))*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(9/2)*C2^2+(-2*d+(9/2)*C1+w-2*R)*C2+2*C1*(R+d))*rf+(1/2)*c^2*C2^3+(-(9/2)*w+4*d-c^2*C1+4*R-c*C3)*C2^2+((1/2)*c^2*C1^2+2*c*C3*C1+(-8*d-8*R+(9/2)*w)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/2)*c*C3*C1+(w+2*C1)*(R+d)))*v^2+(C2*(C2+R+d)*rf-(1/6)*c^2*C2^3+(w+(1/6)*c^2*C1-(9/2)*R+(1/2)*c*C3-(9/2)*d)*C2^2+(-(1/2)*c*C3*C1-(R-(9/2)*C1+d-w)*(R+d))*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(R+d+2*C2))*sin(u)^2+(1/4)*c*pi*(rf^2+((2-(10/3)*c^2)*C2+(10/3)*c^2*C1-2*C1+2*w)*rf+(1+(2/3)*c^2)*C2^2+((-(4/3)*C1-(10/3)*w)*c^2+2*w-2*C1)*C2+(10/3)*C1*((1/5)*C1+w)*c^2+(w-C1)^2)*(-C2+C1)*v^3+((1/4)*rf^2*pi*c*C2+((1/2)*c*((-(7/6)*c^2+3/2)*C2^2+(-d+2*c*C3+(7/6)*c^2*C1+w-R-(3/2)*C1)*C2+C1*(d-2*c*C3+R))*pi-(11/24*(-6/11+c^2))*(-C2+C1)*b)*rf+(5/6)*c*((3/5+(1/10)*c^2)*C2^3+((-(1/5)*C1+d+R-(7/10)*w)*c^2-(3/5)*c*C3-(6/5)*C1-(3/5)*d-(3/5)*R+(9/10)*w)*C2^2+(-2*C1*(-(1/20)*C1+d+R-(7/20)*w)*c^2+(6/5)*C3*(w+C1)*c-(3/5*(w-2*C1))*(-(1/2)*w+d+R+(1/2)*C1))*C2+C1*(C1*(R+d)*c^2-(6/5*((1/2)*C1+w))*C3*c+(3/5*(w-C1))*(R+d)))*pi-(11/24*((-6/11-(7/11)*c^2)*C2+((7/11)*C1+w)*c^2+(6/11)*C1-(6/11)*w))*(-C2+C1)*b)*v^2+(((1/2)*c*(-(1/2)*c*C3-(1/2)*C2+R+d)*C2*pi+(1/8*((1-(4/3)*c^2)*C2+c*C3))*b)*rf+(1/4*((-1+(1/3)*c^2)*C2^3+((-(1/3)*C1-(7/3)*R-(7/3)*d)*c^2+c*C3-w+C1+3*d+3*R)*C2^2+((7/3)*C1*(R+d)*c^2+(4*(-(1/4)*w+R+d-(1/4)*C1))*C3*c-(R+d)*(R+d-2*w+3*C1))*C2+C1*(R+d)*(R+d-4*c*C3)))*c*pi-(11/24*((-9/11-(3/11)*c^2)*C2^2+(((4/11)*w+(3/11)*C1-d-R)*c^2+(9/11)*c*C3+(9/11)*C1+(6/11)*R-(3/11)*w+(6/11)*d)*C2+C1*(R+d)*c^2-(3/11)*C3*(w+3*C1)*c-(6/11)*C1*(R+d)))*b)*v+(1/4*(R+d))*c*C2*(R-c*C3-C2+d)*pi+(1/8*((-1+(1/3)*c^2)*C2^2+((-(4/3)*R-(4/3)*d)*c^2+c*C3+R+d)*C2+c*C3*(R+d)))*b)*cos(u)^2+c^2*pi^2*((rf^2+(4*C1-4*C2+2*w)*rf+(1/3)*c^2*C2^2+(-(2/3)*c^2*C1-4*w)*C2+(1/3)*c^2*C1^2+w*(4*C1+w))*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(9/2)*C2^2+(-2*d+(9/2)*C1+w-2*R)*C2+2*C1*(R+d))*rf+(1/2)*c^2*C2^3+(-(9/2)*w+4*d-c^2*C1+4*R-c*C3)*C2^2+((1/2)*c^2*C1^2+2*c*C3*C1+(-8*d-8*R+(9/2)*w)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/2)*c*C3*C1+(w+2*C1)*(R+d)))*v^2+(C2*(C2+R+d)*rf-(1/6)*c^2*C2^3+(w+(1/6)*c^2*C1-(9/2)*R+(1/2)*c*C3-(9/2)*d)*C2^2+(-(1/2)*c*C3*C1-(R-(9/2)*C1+d-w)*(R+d))*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(R+d+2*C2))*sin(u)^4+(1/2)*c*(c*pi*(rf^2+((2-(10/3)*c^2)*C2+(10/3)*c^2*C1-2*C1+2*w)*rf+(1+(2/3)*c^2)*C2^2+((-(4/3)*C1-(10/3)*w)*c^2+2*w-2*C1)*C2+(10/3)*C1*((1/5)*C1+w)*c^2+(w-C1)^2)*(-C2+C1)*v^3+(rf^2*pi*c*C2+(2*c*((-(7/6)*c^2+3/2)*C2^2+(-d+2*c*C3+(7/6)*c^2*C1+w-R-(3/2)*C1)*C2+C1*(d-2*c*C3+R))*pi-(11/6*(-6/11+c^2))*(-C2+C1)*b)*rf+(10/3)*c*((3/5+(1/10)*c^2)*C2^3+((-(1/5)*C1+d+R-(7/10)*w)*c^2-(3/5)*c*C3-(6/5)*C1-(3/5)*d-(3/5)*R+(9/10)*w)*C2^2+(-2*C1*(-(1/20)*C1+d+R-(7/20)*w)*c^2+(6/5)*C3*(w+C1)*c-(3/5*(w-2*C1))*(-(1/2)*w+d+R+(1/2)*C1))*C2+C1*(C1*(R+d)*c^2-(6/5*((1/2)*C1+w))*C3*c+(3/5*(w-C1))*(R+d)))*pi-(11/6*((-6/11-(7/11)*c^2)*C2+((7/11)*C1+w)*c^2+(6/11)*C1-(6/11)*w))*(-C2+C1)*b)*v^2+((2*c*(-(1/2)*c*C3-(1/2)*C2+R+d)*C2*pi+(1/2*((1-(4/3)*c^2)*C2+c*C3))*b)*rf+((-1+(1/3)*c^2)*C2^3+((-(1/3)*C1-(7/3)*R-(7/3)*d)*c^2+c*C3-w+C1+3*d+3*R)*C2^2+((7/3)*C1*(R+d)*c^2+(4*(-(1/4)*w+R+d-(1/4)*C1))*C3*c-(R+d)*(R+d-2*w+3*C1))*C2+C1*(R+d)*(R+d-4*c*C3))*c*pi-(11/6*((-9/11-(3/11)*c^2)*C2^2+(((4/11)*w+(3/11)*C1-d-R)*c^2+(9/11)*c*C3+(9/11)*C1+(6/11)*R-(3/11)*w+(6/11)*d)*C2+C1*(R+d)*c^2-(3/11)*C3*(w+3*C1)*c-(6/11)*C1*(R+d)))*b)*v+(R+d)*c*C2*(R-c*C3-C2+d)*pi+(1/2*((-1+(1/3)*c^2)*C2^2+((-(4/3)*R-(4/3)*d)*c^2+c*C3+R+d)*C2+c*C3*(R+d)))*b)*pi*sin(u)^2+(1/2)*pi^2*c^2*(-C2+C1)^2*(1+c^2)*(rf+w)*v^3+(1/2*((((2*c+c^3)*C2-c^2*C3)*pi-(2/3)*c^2*b-(1/2)*b)*rf+c*((2*c^3*C3+(-d+w-R)*c^2+c*C3-d+2*w-R)*C2-2*c^3*C3*C1+C1*(R+d)*c^2-C3*(w+C1)*c+C1*(R+d))*pi-(1/2*((-(1/3)*c^2-c^4+1)*C2+c^4*C1+((1/3)*C1+(4/3)*w)*c^2+w-C1))*b))*c*pi*(-C2+C1)*v^2+(-(1/2*(c*C2*(c*C3-C2)*pi^2+(2/3*(c^2+3/4))*C2*b*pi+(1/12)*b^2*c))*c*rf-(1/2)*c^2*(((R+d)*c^2-c*C3+2*d+2*R-w)*C2^2+(((-R-d)*C1+2*C3^2)*c^2-C3*(-C1-w+R+d)*c-2*C1*(R+d))*C2+c*C3*C1*(d-2*c*C3+R))*pi^2-(1/3*((-(1/2)*c^2+3/2)*C2^2+((9/2)*c^3*C3+(-R+w-d+(1/2)*C1)*c^2-(3/4)*c*C3-(3/4)*R+(3/4)*w-(3/2)*C1-(3/4)*d)*C2+C1*(-(9/2)*c^3*C3+(R+d)*c^2+(3/4)*c*C3+(3/4)*d+(3/4)*R)))*c*b*pi+(1/8*((1-c^4+c^2)*C2+c^4*C1+(-(1/3)*w-C1)*c^2-C1))*b^2)*v-(1/2)*C2*c^2*(c*C3-C2)*(R+d)*pi^2-(1/3)*c*((-3/4+(1/4)*c^2)*C2^2+(c^2+3/4)*(R+d)*C2+(3/4)*c^2*C3^2)*b*pi-(1/24*(3*C2+(3*c^2*C3+(R+d)*c-3*C3)*c))*b^2)*v^2*cos(c*u-omega*time)^2+3*rf*(c^2*pi^2*((rf^2+(2*C1-2*C2+2*w)*rf+(-1/2-(1/3)*c^2)*C2^2+((2/3)*c^2*C1+C1-2*w)*C2-(1/2)*C1^2-(1/3)*c^2*C1^2+w^2+2*w*C1)*(-C2+C1)^2*v^4+(2*((1/2)*rf^2*C2+(-(7/4)*C2^2+(w-R+(7/4)*C1-d)*C2+C1*(R+d))*rf+(-(1/4)*c^2-7/12)*C2^3+(-(1/3)*c*C3+R+(1/2)*c^2*C1-(7/4)*w+d+(7/6)*C1)*C2^2+(-(1/4)*c^2*C1^2+(2/3)*c*C3*C1-(7/12)*C1^2+(-2*d+(7/4)*w-2*R)*C1-w*(-(1/2)*w+d+R))*C2+C1*(-(1/3)*c*C3*C1+(w+C1)*(R+d))))*(-C2+C1)*v^3+((1/6)*rf^2*C2^2+2*C2*(-(5/6)*C2^2+(-d+(5/6)*C1-R+(1/6)*w)*C2+C1*(R+d))*rf+(-5/6-(1/6)*c^2)*C2^4+(-(1/2)*c*C3-(5/3)*w+(5/3)*C1+(1/3)*c^2*C1+(7/2)*R+(7/2)*d)*C2^3+(-(1/6)*c^2*C1^2+c*C3*C1-(5/6)*C1^2+(-7*d+(5/3)*w-7*R)*C1+R^2+(2*d-2*w)*R-2*w*d+(1/6)*w^2+d^2)*C2^2-(2*((1/4)*c*C3*C1+(R-(7/4)*C1+d-w)*(R+d)))*C1*C2+C1^2*(R+d)^2)*v^2+((1/3*((1/2)*C2+R+d))*C2*rf+(1/6)*C2^3+(-(5/3)*d-(5/3)*R-(1/6)*C1+(1/6)*w)*C2^2-(R-(1/3)*w-(5/3)*C1+d)*(R+d)*C2+C1*(R+d)^2)*C2*v+(1/6)*C2^2*(R+d)*(C2+R+d))*cos(u)^4+2*c*(c*pi*((rf^2+(2*C1-2*C2+2*w)*rf+(-1/2-(1/3)*c^2)*C2^2+((2/3)*c^2*C1+C1-2*w)*C2-(1/2)*C1^2-(1/3)*c^2*C1^2+w^2+2*w*C1)*(-C2+C1)^2*v^4+(2*((1/2)*rf^2*C2+(-(7/4)*C2^2+(w-R+(7/4)*C1-d)*C2+C1*(R+d))*rf+(-(1/4)*c^2-7/12)*C2^3+(-(1/3)*c*C3+R+(1/2)*c^2*C1-(7/4)*w+d+(7/6)*C1)*C2^2+(-(1/4)*c^2*C1^2+(2/3)*c*C3*C1-(7/12)*C1^2+(-2*d+(7/4)*w-2*R)*C1-w*(-(1/2)*w+d+R))*C2+C1*(-(1/3)*c*C3*C1+(w+C1)*(R+d))))*(-C2+C1)*v^3+((1/6)*rf^2*C2^2+2*C2*(-(5/6)*C2^2+(-d+(5/6)*C1-R+(1/6)*w)*C2+C1*(R+d))*rf+(-5/6-(1/6)*c^2)*C2^4+(-(1/2)*c*C3-(5/3)*w+(5/3)*C1+(1/3)*c^2*C1+(7/2)*R+(7/2)*d)*C2^3+(-(1/6)*c^2*C1^2+c*C3*C1-(5/6)*C1^2+(-7*d+(5/3)*w-7*R)*C1+R^2+(2*d-2*w)*R-2*w*d+(1/6)*w^2+d^2)*C2^2-(2*((1/4)*c*C3*C1+(R-(7/4)*C1+d-w)*(R+d)))*C1*C2+C1^2*(R+d)^2)*v^2+((1/3*((1/2)*C2+R+d))*C2*rf+(1/6)*C2^3+(-(5/3)*d-(5/3)*R-(1/6)*C1+(1/6)*w)*C2^2-(R-(1/3)*w-(5/3)*C1+d)*(R+d)*C2+C1*(R+d)^2)*C2*v+(1/6)*C2^2*(R+d)*(C2+R+d))*sin(u)^2+(1/4*(rf^2+((4/3-(1/3)*c^2)*C2+(1/3)*c^2*C1-(4/3)*C1+2*w)*rf+(1/3+(1/3)*c^2)*C2^2+((-(2/3)*C1-(1/3)*w)*c^2+(4/3)*w-(2/3)*C1)*C2+(1/3)*C1*(w+C1)*c^2+(w-(1/3)*C1)*(w-C1)))*c*pi*(-C2+C1)^2*v^4+(1/2*((5/6)*rf^2*pi*c*C2+(((-(1/6)*c^2+5/3)*C2^2+(-d+(3/2)*c*C3+(1/6)*c^2*C1+(5/3)*w-R-(5/3)*C1)*C2+C1*(d-(3/2)*c*C3+R))*c*pi-(1/3*(-3/2+c^2))*(-C2+C1)*b)*rf+(1/6)*c*((3+2*c^2)*C2^3+((-4*C1+d+R-w)*c^2+c*C3-6*C1-4*d-4*R+10*w)*C2^2+(-(2*(-C1+d-(1/2)*w+R))*C1*c^2+(9*(w-(2/9)*C1))*C3*c+3*C1^2+(8*R-10*w+8*d)*C1-6*w*(-(5/6)*w+R+d))*C2+(C1*(R+d)*c^2-(9*(-(1/9)*C1+w))*C3*c+(6*(w-(2/3)*C1))*(R+d))*C1)*pi-(1/3*((-3/2-c^2)*C2+(w+C1)*c^2+(3/2)*C1-(3/2)*w))*(-C2+C1)*b))*(-C2+C1)*v^3+((1/6)*C2*(c*pi*C2-(1/4)*b)*rf^2+((5/6)*c*((4/5)*C2^2+(-d+(1/2)*c*C3-(4/5)*C1+(2/5)*w-R)*C2+C1*(-(1/2)*c*C3+R+d))*C2*pi+(1/4*(((1/2)*c^2-4/3)*C2^2+(-(1/2)*c^2*C1-c*C3-(1/3)*w+(4/3)*C1)*C2+c*C3*C1))*b)*rf+(1/4*(((1/3)*c^2+1)*C2^4+(((1/3)*d+(1/3)*R-(2/3)*C1)*c^2+(2/3)*c*C3-(10/3)*R+(8/3)*w-2*C1-(10/3)*d)*C2^3+(-(2/3*(-(1/2)*C1+d+R))*C1*c^2-3*C3*(d+R-(5/9)*w+(4/9)*C1)*c+C1^2+((20/3)*d+(20/3)*R-(8/3)*w)*C1+R^2+(2*d-(10/3)*w)*R+(2/3)*w^2+d^2-(10/3)*w*d)*C2^2-2*C1*(-(1/6)*C1*(R+d)*c^2-3*C3*((1/9)*C1-(5/18)*w+d+R)*c+(R+(5/3)*C1+d-(5/3)*w)*(R+d))*C2+C1^2*(R+d)*(R-3*c*C3+d)))*c*pi-(1/6*((13/4+(5/4)*c^2)*C2^3+((-(5/2)*C1+R+d-(3/4)*w)*c^2-(3/2)*c*C3-(3/2)*d-(3/2)*R+2*w-(13/2)*C1)*C2^2+(-2*C1*(-(5/8)*C1+d+R-(3/8)*w)*c^2+(3/2)*C3*(w+2*C1)*c+(13/4)*C1^2+(3*R-2*w+3*d)*C1+(1/4)*w^2)*C2+C1*(C1*(R+d)*c^2-(3/2)*C3*(w+C1)*c-(3/2)*C1*(R+d))))*b)*v^2+((1/3)*C2*(c*(-(1/2)*C2+R+d)*C2*pi-(1/4*(R-(1/2)*c*C3+d-C2))*b)*rf+(5/12*(-(1/5)*C2^3+((8/5)*R+(8/5)*d-(1/5)*c*C3+(1/5)*C1-(2/5)*w)*C2^2+(((1/5)*C1+R+d)*C3*c-(R+d-(4/5)*w+(8/5)*C1)*(R+d))*C2+C1*(R+d)*(R-c*C3+d)))*c*C2*pi+(1/4*((4/3+(1/6)*c^2)*C2^3+(((1/2)*R+(1/2)*d-(1/6)*C1)*c^2-(5/6)*c*C3-(4/3)*d-(4/3)*C1-(4/3)*R+(1/3)*w)*C2^2+(-(1/2)*C1*(R+d)*c^2-C3*(R-(1/6)*w-(5/6)*C1+d)*c-(1/3*(-4*C1+w))*(R+d))*C2+c*C3*C1*(R+d)))*b)*v+(1/6*(c*C2*(R+d)*(R-C2+d)*pi-(1/4*(C2^2+(-2*d-2*R-c*C3)*C2+(R+d)*(R-c*C3+d)))*b))*C2)*pi*cos(u)^2+c^2*pi^2*((rf^2+(2*C1-2*C2+2*w)*rf+(-1/2-(1/3)*c^2)*C2^2+((2/3)*c^2*C1+C1-2*w)*C2-(1/2)*C1^2-(1/3)*c^2*C1^2+w^2+2*w*C1)*(-C2+C1)^2*v^4+(2*((1/2)*rf^2*C2+(-(7/4)*C2^2+(w-R+(7/4)*C1-d)*C2+C1*(R+d))*rf+(-(1/4)*c^2-7/12)*C2^3+(-(1/3)*c*C3+R+(1/2)*c^2*C1-(7/4)*w+d+(7/6)*C1)*C2^2+(-(1/4)*c^2*C1^2+(2/3)*c*C3*C1-(7/12)*C1^2+(-2*d+(7/4)*w-2*R)*C1-w*(-(1/2)*w+d+R))*C2+C1*(-(1/3)*c*C3*C1+(w+C1)*(R+d))))*(-C2+C1)*v^3+((1/6)*rf^2*C2^2+2*C2*(-(5/6)*C2^2+(-d+(5/6)*C1-R+(1/6)*w)*C2+C1*(R+d))*rf+(-5/6-(1/6)*c^2)*C2^4+(-(1/2)*c*C3-(5/3)*w+(5/3)*C1+(1/3)*c^2*C1+(7/2)*R+(7/2)*d)*C2^3+(-(1/6)*c^2*C1^2+c*C3*C1-(5/6)*C1^2+(-7*d+(5/3)*w-7*R)*C1+R^2+(2*d-2*w)*R-2*w*d+(1/6)*w^2+d^2)*C2^2-(2*((1/4)*c*C3*C1+(R-(7/4)*C1+d-w)*(R+d)))*C1*C2+C1^2*(R+d)^2)*v^2+((1/3*((1/2)*C2+R+d))*C2*rf+(1/6)*C2^3+(-(5/3)*d-(5/3)*R-(1/6)*C1+(1/6)*w)*C2^2-(R-(1/3)*w-(5/3)*C1+d)*(R+d)*C2+C1*(R+d)^2)*C2*v+(1/6)*C2^2*(R+d)*(C2+R+d))*sin(u)^4+(1/2*((rf^2+((4/3-(1/3)*c^2)*C2+(1/3)*c^2*C1-(4/3)*C1+2*w)*rf+(1/3+(1/3)*c^2)*C2^2+((-(2/3)*C1-(1/3)*w)*c^2+(4/3)*w-(2/3)*C1)*C2+(1/3)*C1*(w+C1)*c^2+(w-(1/3)*C1)*(w-C1))*c*pi*(-C2+C1)^2*v^4+(2*((5/6)*rf^2*pi*c*C2+(((-(1/6)*c^2+5/3)*C2^2+(-d+(3/2)*c*C3+(1/6)*c^2*C1+(5/3)*w-R-(5/3)*C1)*C2+C1*(d-(3/2)*c*C3+R))*c*pi-(1/3*(-3/2+c^2))*(-C2+C1)*b)*rf+(1/6)*c*((3+2*c^2)*C2^3+((-4*C1+d+R-w)*c^2+c*C3-6*C1-4*d-4*R+10*w)*C2^2+(-(2*(-C1+d-(1/2)*w+R))*C1*c^2+(9*(w-(2/9)*C1))*C3*c+3*C1^2+(8*R-10*w+8*d)*C1-6*w*(-(5/6)*w+R+d))*C2+(C1*(R+d)*c^2-(9*(-(1/9)*C1+w))*C3*c+(6*(w-(2/3)*C1))*(R+d))*C1)*pi-(1/3*((-3/2-c^2)*C2+(w+C1)*c^2+(3/2)*C1-(3/2)*w))*(-C2+C1)*b))*(-C2+C1)*v^3+((2/3)*C2*(c*pi*C2-(1/4)*b)*rf^2+((10/3)*c*((4/5)*C2^2+(-d+(1/2)*c*C3-(4/5)*C1+(2/5)*w-R)*C2+C1*(-(1/2)*c*C3+R+d))*C2*pi+(((1/2)*c^2-4/3)*C2^2+(-(1/2)*c^2*C1-c*C3-(1/3)*w+(4/3)*C1)*C2+c*C3*C1)*b)*rf+(((1/3)*c^2+1)*C2^4+(((1/3)*d+(1/3)*R-(2/3)*C1)*c^2+(2/3)*c*C3-(10/3)*R+(8/3)*w-2*C1-(10/3)*d)*C2^3+(-(2/3*(-(1/2)*C1+d+R))*C1*c^2-3*C3*(d+R-(5/9)*w+(4/9)*C1)*c+C1^2+((20/3)*d+(20/3)*R-(8/3)*w)*C1+R^2+(2*d-(10/3)*w)*R+(2/3)*w^2+d^2-(10/3)*w*d)*C2^2-2*C1*(-(1/6)*C1*(R+d)*c^2-3*C3*((1/9)*C1-(5/18)*w+d+R)*c+(R+(5/3)*C1+d-(5/3)*w)*(R+d))*C2+C1^2*(R+d)*(R-3*c*C3+d))*c*pi-(2/3*((13/4+(5/4)*c^2)*C2^3+((-(5/2)*C1+R+d-(3/4)*w)*c^2-(3/2)*c*C3-(3/2)*d-(3/2)*R+2*w-(13/2)*C1)*C2^2+(-2*C1*(-(5/8)*C1+d+R-(3/8)*w)*c^2+(3/2)*C3*(w+2*C1)*c+(13/4)*C1^2+(3*R-2*w+3*d)*C1+(1/4)*w^2)*C2+C1*(C1*(R+d)*c^2-(3/2)*C3*(w+C1)*c-(3/2)*C1*(R+d))))*b)*v^2+((4/3)*C2*(c*(-(1/2)*C2+R+d)*C2*pi-(1/4*(R-(1/2)*c*C3+d-C2))*b)*rf+(5/3*(-(1/5)*C2^3+((8/5)*R+(8/5)*d-(1/5)*c*C3+(1/5)*C1-(2/5)*w)*C2^2+(((1/5)*C1+R+d)*C3*c-(R+d-(4/5)*w+(8/5)*C1)*(R+d))*C2+C1*(R+d)*(R-c*C3+d)))*c*C2*pi+((4/3+(1/6)*c^2)*C2^3+(((1/2)*R+(1/2)*d-(1/6)*C1)*c^2-(5/6)*c*C3-(4/3)*d-(4/3)*C1-(4/3)*R+(1/3)*w)*C2^2+(-(1/2)*C1*(R+d)*c^2-C3*(R-(1/6)*w-(5/6)*C1+d)*c-(1/3*(-4*C1+w))*(R+d))*C2+c*C3*C1*(R+d))*b)*v+(2/3*(c*C2*(R+d)*(R-C2+d)*pi-(1/4*(C2^2+(-2*d-2*R-c*C3)*C2+(R+d)*(R-c*C3+d)))*b))*C2))*c*pi*sin(u)^2+(1/6)*pi^2*c^2*(-C2+C1)^3*(rf+w)*v^4+(1/6)*c*(((3*c*C2-2*c^2*C3)*pi-2*c^2*b-(3/2)*b)*rf+((c*C3-R+3*w-d)*C2-(2*((1/2)*C1+w))*C3*c+C1*(R+d))*c*pi-(2*(((1/4)*c^2+1/4)*C2+(-(1/4)*C1+w)*c^2-(1/4)*C1+(3/4)*w))*b)*pi*(-C2+C1)^2*v^3-(1/3*(((c*C3-(3/2)*C2)*c*C2*pi-(1/2*((-3-2*c^2)*C2+c*C3))*b)*c*pi*rf+((-c*C3+(3/2)*d+(3/2)*R-(3/2)*w)*C2^2+((3/2)*c^2*C3^2-C3*(-C1-w+R+d)*c-(3/2)*C1*(R+d))*C2+C1*(d-(3/2)*c*C3+R)*c*C3)*c^2*pi^2+(((1/2)*c^2+3/4)*C2^2+((3/2)*c^3*C3+(-R+w-d-(1/2)*C1)*c^2+(1/4)*c*C3-(3/4)*C1+(3/2)*w-(3/4)*d-(3/4)*R)*C2-(3/2)*c^3*C3*C1+C1*(R+d)*c^2-(1/2*((1/2)*C1+w))*C3*c+(3/4)*C1*(R+d))*c*b*pi+(1/4*(3/2+c^2))*(-C2+C1)*b^2))*(-C2+C1)*v^2+((1/3)*c*((1/2)*c*pi^2*C2^3+C2*(-(3/4)*C2+c*C3)*b*pi+(1/8)*b^2*(c*C2+C3))*rf-(1/3)*c^2*C2*((-(1/2)*c*C3+(3/2)*d-(1/2)*w+(3/2)*R)*C2^2+(-(-(1/2)*C1+d+R)*C3*c-(3/2)*C1*(R+d))*C2+c*C3*C1*(R+d))*pi^2+(1/6)*c*((-3/2-(1/2)*c^2)*C2^3+((2*R+(1/2)*C1+2*d)*c^2-(3/2)*w+3*d+3*R+(3/2)*C1)*C2^2+(((-2*d-2*R)*C1+3*C3^2)*c^2-C3*(R+d-2*w)*c-3*C1*(R+d))*C2+c*C3*C1*(R-3*c*C3+d))*b*pi-(1/8)*b^2*((-(2/3)*c^2-2)*C2^2+(-c^3*C3+(-(1/3)*w+(2/3)*C1)*c^2+(5/3)*c*C3+2*C1)*C2+c*(-(1/3)*w+c^2*C1-(5/3)*C1)*C3))*v+(1/6)*c^2*C2^3*(R+d)*pi^2+(1/3)*c*((1/4)*C2^2+(-(1/4)*c*C3-(3/4)*R-(3/4)*d)*C2+c*C3*(R+d))*C2*b*pi+(1/24*(-3*C2^2+c*((R+d)*c+2*C3)*C2+c*C3*(R+d)))*b^2)*v*cos(c*u-omega*time)+c^2*pi^2*((-C2+C1)*v+C2)*((rf^2+(C1+2*w-C2)*rf+(-(1/2)*c^2-1/2)*C2^2+(-w+c^2*C1+C1)*C2-(1/2)*C1^2-(1/2)*c^2*C1^2+w*C1+w^2)*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(3/2)*C2^2+(w-2*R+(3/2)*C1-2*d)*C2+2*C1*(R+d))*rf+(-(1/2)*c^2-1)*C2^3+(-(1/2)*c*C3+R+c^2*C1-(3/2)*w+d+2*C1)*C2^2+(-(1/2)*c^2*C1^2+c*C3*C1-C1^2+(-2*d+(3/2)*w-2*R)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/4)*c*C3*C1+((1/2)*C1+w)*(R+d)))*v^2+(((1/2)*C2+R+d)*C2*rf+(1/2)*C2^3+(-(3/2)*d-(1/2)*C1-(3/2)*R+(1/2)*w)*C2^2-(R+d)*(R-(3/2)*C1-w+d)*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(C2+R+d))*(-C2+C1)*v*cos(u)^4+2*c*pi*(c*pi*((-C2+C1)*v+C2)*((rf^2+(C1+2*w-C2)*rf+(-(1/2)*c^2-1/2)*C2^2+(-w+c^2*C1+C1)*C2-(1/2)*C1^2-(1/2)*c^2*C1^2+w*C1+w^2)*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(3/2)*C2^2+(w-2*R+(3/2)*C1-2*d)*C2+2*C1*(R+d))*rf+(-(1/2)*c^2-1)*C2^3+(-(1/2)*c*C3+R+c^2*C1-(3/2)*w+d+2*C1)*C2^2+(-(1/2)*c^2*C1^2+c*C3*C1-C1^2+(-2*d+(3/2)*w-2*R)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/4)*c*C3*C1+((1/2)*C1+w)*(R+d)))*v^2+(((1/2)*C2+R+d)*C2*rf+(1/2)*C2^3+(-(3/2)*d-(1/2)*C1-(3/2)*R+(1/2)*w)*C2^2-(R+d)*(R-(3/2)*C1-w+d)*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(C2+R+d))*(-C2+C1)*v*sin(u)^2+(1/4)*pi*c*(-C2+C1)^3*(rf+w)*(w+rf+C2-C1)*v^5+(1/2*(rf^2*pi*c*C2+(c*((3/2)*C2^2+(c*C3-(3/2)*C1-d+2*w-R)*C2+C1*(R-c*C3+d))*pi+(1/4)*b*(c^2+2)*(-C2+C1))*rf+(((3/2)*w-(1/2)*R+(1/2)*c*C3-(1/2)*d)*C2^2+(C3*(w-C1)*c+(d+R-(3/2)*w)*C1-w*(R+d-w))*C2+C1*(-(1/2)*C1+w)*(R-c*C3+d))*c*pi+(1/4*(-C2+C1))*((2+2*c^2)*C2+(w-2*C1)*c^2+2*w-2*C1)*b))*(-C2+C1)^2*v^4+(1/4*((-(1/2)*b+c*pi*C2)*C2*rf^2+((4*((3/4)*C2^2+((1/2)*c*C3+(1/2)*w-R-(3/4)*C1-d)*C2+C1*(-(1/2)*c*C3+R+d)))*c*C2*pi+(3/2*((-5/3-(1/3)*c^2)*C2^2+((5/3)*C1+(1/3)*c^2*C1-(2/3)*w-c*C3)*C2+c*C3*C1))*b)*rf+c*((2*c*C3-3*d+3*w-3*R)*C2^3+(-2*C3*(2*C1-w+R+d)*c+(6*d-3*w+6*R)*C1+R^2+(2*d-4*w)*R+w^2-4*w*d+d^2)*C2^2-2*C1*(-(2*(-(1/2)*w+d+R+(1/2)*C1))*C3*c+(R+d+(3/2)*C1-2*w)*(R+d))*C2+C1^2*(R+d)*(d-2*c*C3+R))*pi+(1/2*((-6-4*c^2)*C2^3+((8*C1+R+d-w)*c^2+c*C3+2*d+2*R-5*w+12*C1)*C2^2+(-2*C1*(2*C1+d-(1/2)*w+R)*c^2-3*C3*(w+(2/3)*C1)*c-6*C1^2+(-4*R+5*w-4*d)*C1-w^2)*C2+C1*(C1*(R+d)*c^2+3*C3*((1/3)*C1+w)*c+2*C1*(R+d))))*b))*(-C2+C1)*v^3+(-(1/8)*C2^2*b*rf^2+(1/2*(c*(-(1/2)*C2+R+d)*C2*(-C2+C1)*pi-(1/2*(2*C2^2+((1/2)*c*C3-2*C1+w-R-d)*C2+C1*(-(1/2)*c*C3+R+d)))*b))*C2*rf+(1/2)*c*C2*((-(1/2)*c*C3+(3/2)*d-(1/2)*w+(3/2)*R)*C2^2+(C3*(d+R+(1/2)*C1)*c-(R+d-w+(3/2)*C1)*(R+d))*C2+C1*(R+d)*(R-c*C3+d))*(-C2+C1)*pi+(3/8*((-(2/3)*c^2-2)*C2^4+(((1/3)*R+(4/3)*C1+(1/3)*d)*c^2+(2/3)*c*C3+(5/3)*R+4*C1-(4/3)*w+(5/3)*d)*C2^3+(-(2/3)*C1*(C1+R+d)*c^2+(R+d-(1/3)*w-(4/3)*C1)*C3*c-2*C1^2+(-(10/3)*d+(4/3)*w-(10/3)*R)*C1+(2/3)*w*(-(1/2)*w+d+R))*C2^2-2*C1*(-(1/6)*C1*(R+d)*c^2+(-(1/6)*w+d-(1/3)*C1+R)*C3*c+(1/3*(-(5/2)*C1+w))*(R+d))*C2+c*C3*C1^2*(R+d)))*b)*v^2+(1/4)*C2*(-(-(1/2)*C2+R+d)*C2*b*rf+c*C2*(R+d)*(R-C2+d)*(-C2+C1)*pi-(1/2*(-2*C2^3+(4*R+c*C3+4*d+2*C1-w)*C2^2+(C3*(R-C1+d)*c-(R+d)*(R+4*C1+d-2*w))*C2+C1*(R+d)*(R-c*C3+d)))*b)*v-(1/8)*C2^2*b*(R+d)*(R-C2+d))*cos(u)^2+c^2*pi^2*((-C2+C1)*v+C2)*((rf^2+(C1+2*w-C2)*rf+(-(1/2)*c^2-1/2)*C2^2+(-w+c^2*C1+C1)*C2-(1/2)*C1^2-(1/2)*c^2*C1^2+w*C1+w^2)*(-C2+C1)*v^3+((1/2)*rf^2*C2+(-(3/2)*C2^2+(w-2*R+(3/2)*C1-2*d)*C2+2*C1*(R+d))*rf+(-(1/2)*c^2-1)*C2^3+(-(1/2)*c*C3+R+c^2*C1-(3/2)*w+d+2*C1)*C2^2+(-(1/2)*c^2*C1^2+c*C3*C1-C1^2+(-2*d+(3/2)*w-2*R)*C1-2*w*(-(1/4)*w+R+d))*C2+2*C1*(-(1/4)*c*C3*C1+((1/2)*C1+w)*(R+d)))*v^2+(((1/2)*C2+R+d)*C2*rf+(1/2)*C2^3+(-(3/2)*d-(1/2)*C1-(3/2)*R+(1/2)*w)*C2^2-(R+d)*(R-(3/2)*C1-w+d)*C2+C1*(R+d)^2)*v+(1/2)*C2*(R+d)*(C2+R+d))*(-C2+C1)*v*sin(u)^4+(1/2*(pi*c*(-C2+C1)^3*(rf+w)*(w+rf+C2-C1)*v^5+(2*(rf^2*pi*c*C2+(c*((3/2)*C2^2+(c*C3-(3/2)*C1-d+2*w-R)*C2+C1*(R-c*C3+d))*pi+(1/4)*b*(c^2+2)*(-C2+C1))*rf+(((3/2)*w-(1/2)*R+(1/2)*c*C3-(1/2)*d)*C2^2+(C3*(w-C1)*c+(d+R-(3/2)*w)*C1-w*(R+d-w))*C2+C1*(-(1/2)*C1+w)*(R-c*C3+d))*c*pi+(1/4*(-C2+C1))*((2+2*c^2)*C2+(w-2*C1)*c^2+2*w-2*C1)*b))*(-C2+C1)^2*v^4+((-(1/2)*b+c*pi*C2)*C2*rf^2+((4*((3/4)*C2^2+((1/2)*c*C3+(1/2)*w-R-(3/4)*C1-d)*C2+C1*(-(1/2)*c*C3+R+d)))*c*C2*pi+(3/2*((-5/3-(1/3)*c^2)*C2^2+((5/3)*C1+(1/3)*c^2*C1-(2/3)*w-c*C3)*C2+c*C3*C1))*b)*rf+c*((2*c*C3-3*d+3*w-3*R)*C2^3+(-2*C3*(2*C1-w+R+d)*c+(6*d-3*w+6*R)*C1+R^2+(2*d-4*w)*R+w^2-4*w*d+d^2)*C2^2-2*C1*(-(2*(-(1/2)*w+d+R+(1/2)*C1))*C3*c+(R+d+(3/2)*C1-2*w)*(R+d))*C2+C1^2*(R+d)*(d-2*c*C3+R))*pi+(1/2*((-6-4*c^2)*C2^3+((8*C1+R+d-w)*c^2+c*C3+2*d+2*R-5*w+12*C1)*C2^2+(-2*C1*(2*C1+d-(1/2)*w+R)*c^2-3*C3*(w+(2/3)*C1)*c-6*C1^2+(-4*R+5*w-4*d)*C1-w^2)*C2+C1*(C1*(R+d)*c^2+3*C3*((1/3)*C1+w)*c+2*C1*(R+d))))*b)*(-C2+C1)*v^3+(-(1/2)*C2^2*b*rf^2+(2*(c*(-(1/2)*C2+R+d)*C2*(-C2+C1)*pi-(1/2*(2*C2^2+((1/2)*c*C3-2*C1+w-R-d)*C2+C1*(-(1/2)*c*C3+R+d)))*b))*C2*rf+2*c*C2*((-(1/2)*c*C3+(3/2)*d-(1/2)*w+(3/2)*R)*C2^2+(C3*(d+R+(1/2)*C1)*c-(R+d-w+(3/2)*C1)*(R+d))*C2+C1*(R+d)*(R-c*C3+d))*(-C2+C1)*pi+(3/2*((-(2/3)*c^2-2)*C2^4+(((1/3)*R+(4/3)*C1+(1/3)*d)*c^2+(2/3)*c*C3+(5/3)*R+4*C1-(4/3)*w+(5/3)*d)*C2^3+(-(2/3)*C1*(C1+R+d)*c^2+(R+d-(1/3)*w-(4/3)*C1)*C3*c-2*C1^2+(-(10/3)*d+(4/3)*w-(10/3)*R)*C1+(2/3)*w*(-(1/2)*w+d+R))*C2^2-2*C1*(-(1/6)*C1*(R+d)*c^2+(-(1/6)*w+d-(1/3)*C1+R)*C3*c+(1/3*(-(5/2)*C1+w))*(R+d))*C2+c*C3*C1^2*(R+d)))*b)*v^2+C2*(-(-(1/2)*C2+R+d)*C2*b*rf+c*C2*(R+d)*(R-C2+d)*(-C2+C1)*pi-(1/2*(-2*C2^3+(4*R+c*C3+4*d+2*C1-w)*C2^2+(C3*(R-C1+d)*c-(R+d)*(R+4*C1+d-2*w))*C2+C1*(R+d)*(R-c*C3+d)))*b)*v-(1/2)*C2^2*b*(R+d)*(R-C2+d)))*c*pi*sin(u)^2+(1/2*(-(1/2)*pi*c*(-C2+C1)^3*(rf+w)*v^4-(1/2*(((3*c*C2-2*c^2*C3)*pi-(1/2)*c^2*b)*rf+((c*C3-R+3*w-d)*C2-(2*((1/2)*C1+w))*C3*c+C1*(R+d))*c*pi-(1/2*((1+c^2)*C2+(w-C1)*c^2-C1))*b))*(-C2+C1)^2*v^3+(c*((c*C3-(3/2)*C2)*C2*pi+(1/4)*b*(c*C2+C3))*rf+((-c*C3+(3/2)*d+(3/2)*R-(3/2)*w)*C2^2+((3/2)*c^2*C3^2-C3*(-C1-w+R+d)*c-(3/2)*C1*(R+d))*C2+C1*(d-(3/2)*c*C3+R)*c*C3)*c*pi+(1/4*((3+2*c^2)*C2^2+((-2*C1+w-R-d)*c^2-2*c*C3-3*C1)*C2+c*(C1*(R+d)*c+C3*(w+2*C1))))*b)*(-C2+C1)*v^2+(-(1/4)*c*C2*(2*pi*C2^2+C3*b)*rf+c*C2*((-(1/2)*c*C3+(3/2)*d-(1/2)*w+(3/2)*R)*C2^2+(-(-(1/2)*C1+d+R)*C3*c-(3/2)*C1*(R+d))*C2+c*C3*C1*(R+d))*pi+(1/4*((3+c^2)*C2^3+((-C1-R-d)*c^2-3*c*C3-3*C1)*C2^2-(-C1*(R+d)*c+C3*(-3*C1+d+R+w))*c*C2+c*C3*C1*(R+d)))*b)*v-(1/4*(2*c*C2^2*(R+d)*pi+(C2^2-c*C3*C2+c*C3*(R+d))*b))*C2))*b)*v*sin(c*u-omega*time)^4+rf*(pi*rf^2*v^2*(cos(u)^2+sin(u)^2+c^2)*cos(c*u-omega*time)^2+rf*(pi*((C1+w-C2+rf)*v+C2+R+d)*cos(u)^2+pi*((C1+w-C2+rf)*v+C2+R+d)*sin(u)^2-c*(pi*C3+(1/2)*b))*v*cos(c*u-omega*time)+((rf+w)*v+R+d)*((-C2+C1)*v+C2)*pi*cos(u)^2+((rf+w)*v+R+d)*((-C2+C1)*v+C2)*pi*sin(u)^2+(1/2)*C3*b)*((4*(cos(u)^2+sin(u)^2+c^2))*rf^4*(c^2+1/4)*pi*v^4*cos(c*u-omega*time)^4+3*rf^3*(pi*(((c^2+2/3)*rf+(-2/3-(8/3)*c^2)*C2+((8/3)*C1+w)*c^2+(2/3)*w+(2/3)*C1)*v+(c^2+2/3)*C2+(R+d)*c^2-(2/3)*c*C3+(2/3)*d+(2/3)*R)*cos(u)^2+pi*(((c^2+2/3)*rf+(-2/3-(8/3)*c^2)*C2+((8/3)*C1+w)*c^2+(2/3)*w+(2/3)*C1)*v+(c^2+2/3)*C2+(R+d)*c^2-(2/3)*c*C3+(2/3)*d+(2/3)*R)*sin(u)^2+(2/3)*c^2*((-(5/2)*C2*c^2+(5/2)*c^2*C1+w-C2+rf+C1)*pi*v+(R+d-(5/2)*c*C3+C2)*pi-(3/4)*c*b))*v^3*cos(c*u-omega*time)^3+rf^2*(((rf^2+(-5*C2*c^2+2*w-4*C2+4*C1+5*c^2*C1)*rf+(4*c^2+1)*C2^2+((-8*C1-5*w)*c^2-4*w-2*C1)*C2+(4*C1^2+5*w*C1)*c^2+w^2+C1^2+4*w*C1)*v^2+((4*C2+2*d+2*C2*c^2-c*C3+2*R)*rf+(-2-3*c^2)*C2^2+((-5*d-5*R+2*w+3*C1)*c^2+5*c*C3+4*w-4*R+2*C1-4*d)*C2+5*C1*(R+d)*c^2-C3*(5*C1+w)*c+(2*(w+2*C1))*(R+d))*v+C2^2+((2*R+2*d)*c^2-c*C3+4*R+4*d)*C2+(R+d)*(R-c*C3+d))*pi*cos(u)^2+((rf^2+(-5*C2*c^2+2*w-4*C2+4*C1+5*c^2*C1)*rf+(4*c^2+1)*C2^2+((-8*C1-5*w)*c^2-4*w-2*C1)*C2+(4*C1^2+5*w*C1)*c^2+w^2+C1^2+4*w*C1)*v^2+((4*C2+2*d+2*C2*c^2-c*C3+2*R)*rf+(-2-3*c^2)*C2^2+((-5*d-5*R+2*w+3*C1)*c^2+5*c*C3+4*w-4*R+2*C1-4*d)*C2+5*C1*(R+d)*c^2-C3*(5*C1+w)*c+(2*(w+2*C1))*(R+d))*v+C2^2+((2*R+2*d)*c^2-c*C3+4*R+4*d)*C2+(R+d)*(R-c*C3+d))*pi*sin(u)^2+(4*(rf+(-(1/4)*c^2-1/4)*C2+w+(1/4)*c^2*C1+(1/4)*C1))*c^2*pi*(-C2+C1)*v^2+4*c*((((3/4)*c*C2-(1/4)*C3)*pi-(1/8)*b)*rf+(-(1/4)*c*C2^2-(-(7/4)*c*C3+d-(1/4)*C1-(3/4)*w+R)*c*C2-(7/4)*c^2*C3*C1+C1*(R+d)*c-(1/4)*C3*w)*pi-(3/8*(-C2*c^2+c^2*C1+(1/3)*w))*b)*v-c*(((-3*R-3*d)*c+C3)*C2+C3*(R-c*C3+d))*pi-(1/2*(c*C2-3*c^2*C3+(R+d)*c+C3))*b)*v^2*cos(c*u-omega*time)^2+2*rf*(((rf+(1/2)*c^2*C1-(1/2)*C2*c^2+C1-C2+w)*(rf+w)*(-C2+C1)*v^3+(rf^2*C2+((-2-(1/2)*c^2)*C2^2+((1/2)*c^2*C1+2*C1+c*C3+2*w-2*d-2*R)*C2+2*C1*(-(1/2)*c*C3+R+d))*rf+(((1/2)*d-(1/2)*w+(1/2)*R)*c^2-2*c*C3+R+d-2*w)*C2^2+(-C1*(-(1/2)*w+d+R)*c^2+C3*(4*C1+w)*c+(-2*d+2*w-2*R)*C1-2*w*(-(1/2)*w+d+R))*C2+(1/2)*C1*(C1*(R+d)*c^2-2*C3*(w+2*C1)*c+(4*((1/2)*C1+w))*(R+d)))*v^2+((2*((1/2)*C2+R+d))*C2*rf+((-(1/2)*d-(1/2)*R)*c^2+c*C3+w-2*R-2*d)*C2^2+((1/2)*C1*(R+d)*c^2+C3*(R-C1+d)*c-(R+d)*(R-2*C1+d-2*w))*C2+C1*(R+d)*(R-c*C3+d))*v+C2*(R+d)*(C2+R+d))*pi*cos(u)^2+((rf+(1/2)*c^2*C1-(1/2)*C2*c^2+C1-C2+w)*(rf+w)*(-C2+C1)*v^3+(rf^2*C2+((-2-(1/2)*c^2)*C2^2+((1/2)*c^2*C1+2*C1+c*C3+2*w-2*d-2*R)*C2+2*C1*(-(1/2)*c*C3+R+d))*rf+(((1/2)*d-(1/2)*w+(1/2)*R)*c^2-2*c*C3+R+d-2*w)*C2^2+(-C1*(-(1/2)*w+d+R)*c^2+C3*(4*C1+w)*c+(-2*d+2*w-2*R)*C1-2*w*(-(1/2)*w+d+R))*C2+(1/2)*C1*(C1*(R+d)*c^2-2*C3*(w+2*C1)*c+(4*((1/2)*C1+w))*(R+d)))*v^2+((2*((1/2)*C2+R+d))*C2*rf+((-(1/2)*d-(1/2)*R)*c^2+c*C3+w-2*R-2*d)*C2^2+((1/2)*C1*(R+d)*c^2+C3*(R-C1+d)*c-(R+d)*(R-2*C1+d-2*w))*C2+C1*(R+d)*(R-c*C3+d))*v+C2*(R+d)*(C2+R+d))*pi*sin(u)^2+pi*c^2*(-C2+C1)^2*(rf+w)*v^3+(((c*C2-C3)*pi-(1/2)*b)*rf+(-c*(-c*C3+d-w+R)*C2-c^2*C3*C1+C1*(R+d)*c-C3*w)*pi-(1/2)*w*b)*c*(-C2+C1)*v^2+(-c*C2*(pi*C3+(1/2)*b)*rf-c*((R+d)*c*C2^2+(((-R-d)*C1+C3^2)*c-C3*(R+d-w))*C2+C3*C1*(R-c*C3+d))*pi-(1/2*(((3/2)*c^2*C3+(-d+w-R)*c-C3)*C2+C1*(-(3/2)*c^2*C3+(R+d)*c+C3)))*b)*v-c*C2*(pi*C3+(1/2)*b)*(R+d))*v*cos(c*u-omega*time)+((-C2+C1)^2*(rf+w)*(rf+w+C2*c^2-c^2*C1)*v^4+(2*(rf^2*C2+((1/2)*c^2*C2^2+(-(1/2)*c^2*C1+2*w+(1/2)*c*C3-R-d)*C2+C1*(-(1/2)*c*C3+R+d))*rf-(1/2)*c*((R+d-w)*c+C3)*C2^2+(C1*(-(1/2)*w+d+R)*c^2+(1/2)*C3*(w+2*C1)*c-w*(R+d-w))*C2-(1/2*(C1*(R+d)*c^2+C3*(w+C1)*c-2*w*(R+d)))*C1))*(-C2+C1)*v^3+(rf^2*C2^2+(4*(((1/2)*w-R-d)*C2+C1*(R+d)))*C2*rf-c*((R+d)*c+C3)*C2^3+(2*C1*(R+d)*c^2-C3*(-2*C1+R+d)*c+R^2+(2*d-4*w)*R-4*w*d+d^2+w^2)*C2^2-2*C1*((1/2)*C1*(R+d)*c^2-(-(1/2)*C1+d+R)*C3*c+(R+d)*(R+d-2*w))*C2+C1^2*(R+d)*(R-c*C3+d))*v^2+2*C2*(rf*C2+(-d+w-R)*C2+C1*(R+d))*(R+d)*v+C2^2*(R+d)^2)*pi*cos(u)^2+((-C2+C1)^2*(rf+w)*(rf+w+C2*c^2-c^2*C1)*v^4+(2*(rf^2*C2+((1/2)*c^2*C2^2+(-(1/2)*c^2*C1+2*w+(1/2)*c*C3-R-d)*C2+C1*(-(1/2)*c*C3+R+d))*rf-(1/2)*c*((R+d-w)*c+C3)*C2^2+(C1*(-(1/2)*w+d+R)*c^2+(1/2)*C3*(w+2*C1)*c-w*(R+d-w))*C2-(1/2*(C1*(R+d)*c^2+C3*(w+C1)*c-2*w*(R+d)))*C1))*(-C2+C1)*v^3+(rf^2*C2^2+(4*(((1/2)*w-R-d)*C2+C1*(R+d)))*C2*rf-c*((R+d)*c+C3)*C2^3+(2*C1*(R+d)*c^2-C3*(-2*C1+R+d)*c+R^2+(2*d-4*w)*R-4*w*d+d^2+w^2)*C2^2-2*C1*((1/2)*C1*(R+d)*c^2-(-(1/2)*C1+d+R)*C3*c+(R+d)*(R+d-2*w))*C2+C1^2*(R+d)*(R-c*C3+d))*v^2+2*C2*(rf*C2+(-d+w-R)*C2+C1*(R+d))*(R+d)*v+C2^2*(R+d)^2)*pi*sin(u)^2-c*(pi*C3+(1/2)*b)*(rf+w)*(-C2+C1)^2*v^3-(c*C2*(pi*C3+(1/2)*b)*rf+c*C3*((c*C3-d+w-R)*C2+C1*(R-c*C3+d))*pi+(1/2*(((-d+w-R)*c-C3)*C2+C1*((R+d)*c+C3)))*b)*(-C2+C1)*v^2-(-(1/2)*b*C3*rf+c*C3*(-C2+C1)*(R+d)*pi+(1/2*(((-R-d)*c-C3)*C2+C1*(R+d)*c-C3*(w-C1)))*b)*C2*v+(1/2)*b*C3*C2*(R+d))*(rf*cos(c*u-omega*time)+C1-C2)*sin(c*u-omega*time)^2+(pi*rf^2*v^2*(cos(u)^2+sin(u)^2+c^2)*cos(c*u-omega*time)^2+rf*(pi*((C1+w-C2+rf)*v+C2+R+d)*cos(u)^2+pi*((C1+w-C2+rf)*v+C2+R+d)*sin(u)^2-c*(pi*C3+(1/2)*b))*v*cos(c*u-omega*time)+((rf+w)*v+R+d)*((-C2+C1)*v+C2)*pi*cos(u)^2+((rf+w)*v+R+d)*((-C2+C1)*v+C2)*pi*sin(u)^2+(1/2)*C3*b)^2*(rf^2*v^2*(1+c^2)*cos(c*u-omega*time)^2+rf*((rf-C2-C2*c^2+c^2*C1+w+C1)*v-c*C3+C2+d+R)*v*cos(c*u-omega*time)+(-C2+C1)*(rf+w)*v^2+(rf*C2+(c*C3-d+w-R)*C2+C1*(R-c*C3+d))*v+C2*(R+d))*cos(c*u-omega*time)*(rf*cos(c*u-omega*time)+C1-C2)^2)/(pi^2*(((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u)))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*(-(1/2)*b/pi+rf*c*cos(c*u-omega*time))-(1/2)*(1-v)*b/pi)*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))-(v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u)))^2+((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u)))^2*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))^2-(2*((v*(C1*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+C2*(1-v)*cos(u))*rf*sin(c*u-omega*time)-(v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*sin(u)+rf*sin(u)*cos(c*u-omega*time)-C2*sin(u))))*(v*((R+d+w+rf)*cos(u)+rf*(cos(u)*cos(c*u-omega*time)-sin(u)*c*sin(c*u-omega*time)))+(R+d)*(1-v)*cos(u))*(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))+(v*(-(R+d+w+rf)*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-(R+d)*(1-v)*sin(u))^2*((v*(-C3+rf*c*cos(c*u-omega*time))-(1-v)*C3)*(C1*cos(u)+rf*cos(u)*cos(c*u-omega*time)-C2*cos(u))-(v*(-C1*sin(u)+rf*(-sin(u)*cos(c*u-omega*time)-cos(u)*c*sin(c*u-omega*time)))-C2*(1-v)*sin(u))*rf*sin(c*u-omega*time))^2)^(3/2)))  ;
                
                vec_t = h * vec_t;
                
                if n <= size(negations,1)
                    vec_t = vec_t .* negations(n,:)';  %match signs to correct n unit vector
                else
                    vec_t = NaN(3,1);
                end
            end
    end
    % velocity of vert is vel of center line pt (i.e. vel of point along outer sheet edge, which is just vel from above) + vel of vector from centerline
    % pt to vert, so we need to get latter starting from u_n
    
    rotmat = rotation_matrix('x',pi) * rotation_matrix('y',pi/2);
    
    
    %     vec = rotmat * (dir_norm * h);  %vector from centerline pt to vert is made by adding cross_norm*h to centerline pt, so subtracting simply yields cross_norm*h
    vec = (dir_norm * h);
    
    dir_norms(:,i) = rotmat * dir_norm;
    vecs(:,i) = rotmat * (dir_norm * h);
    
    pt(:,i) = rotmat * (pt_edge + vec);  %coords of edge pt + vector from edge pt to wingtip = coord of vert
    
    if nargout >= 2
        %     vel(:,i) = vel_edge + rotmat * vec_t;  % velocity of point on edge ("centerline") + velocity of vector from edge pt to vert on wingtip
        vel(:,i) = rotmat * (vel_edge + vec_t);
    end
end

pt(1,:) = pt(1,:) + geom.shift;

